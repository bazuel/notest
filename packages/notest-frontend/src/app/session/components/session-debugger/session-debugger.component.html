<div *ngIf="session" class="w-full h-full flex bg-nt-50">
  <div class="h-full flex-1 overflow-auto scrollbar-sm">
    <div class="flex gap-4 p-4 items-center">
      <input class="input-on-focus font-semibold text-gray-500" [(ngModel)]="session.info.title"
             (ngModelChange)="debouncedSaveSession()"/>
      <button class="h-fit" *ngIf="ready" title="Go to session Preview Mode" (click)="goToPreview()">Session Preview
      </button>
    </div>
    <div
      class="group px-6 py-1.5 rounded-full bg-white mx-6 text-gray-500 border border-gray-300 flex items-center">
      {{session.url}}
      <nt-icon class="opacity-0 group-hover:opacity-100 ml-auto cursor-pointer" name="copy"
               (click)="copyToClipboard(session.url)"></nt-icon>
    </div>
    <nt-player class="w-full p-5" *ngIf="ready" [session]="eventList"></nt-player>
    <div class="flex flex-row">
      <div class="flex items-center">
        <button class="m-4 bo-button" *ngIf="ready" (click)="getSessionTest()">Generate test e2e</button>
        <button class="m-4 bo-button"
                *ngIf="ready && session.info?.e2eScript && !generatingScript"
                (click)="showScript = true">Show test e2e
        </button>
      </div>
      <div *ngIf="generatingScript" class="flex flex-row items-center justify-center">
        <div class="bo-loading m-4"></div>
        <div class="text-nt-300 text-bold">Generating Script...</div>
      </div>
    </div>
  </div>
  <div class="relative w-1/3 h-full p-3">
    <nt-session-devtool
      class="block rounded-md overflow-hidden shadow-md transition-all cursor-pointer duration-400 h-full"
      [events]="eventList">
      <!-- [collapsed]="toolSelected != 'devtool'"-->
      <!-- [ngClass]="{collapsed:toolSelected != 'devtool','h-full':toolSelected == 'devtool'}"-->
      <!-- (click)="toolSelected = 'devtool'">-->
    </nt-session-devtool>
    <!--    <div *ngIf="toolSelected" class="absolute bottom-3 left-1/2 transform -translate-x-1/2 cursor-pointer"-->
    <!--         (click)="toolSelected = undefined">-->
    <!--      <nt-icon class="w-8 h-8 text-gray-500" name="arrow_up"></nt-icon>-->
    <!--    </div>-->
  </div>

</div>

<nt-popup *ngIf="showScript" (close)="showScript = false" (clickOutside)="showScript = false">
  <nt-codemirror-editor
    [script]="session.info.e2eScript"
    class="editor"
    label="Test e2e">
  </nt-codemirror-editor>
</nt-popup>

<nt-popup *ngIf="jsonTemplate" [closeClickOutside]=false (close)="jsonTemplate = undefined">
  <bl-json-template class="block w-[1000px] h-[800px]" [data]="jsonTemplate!"></bl-json-template>
</nt-popup>
