<div *ngIf="session" class="w-full h-full flex">
  <div class="h-full flex-1 overflow-auto scrollbar-sm">
    <div class="flex gap-4 p-4 items-center">
      <input class="input-on-focus font-semibold text-gray-500" [(ngModel)]="session.info.title"
             (ngModelChange)="debouncedSaveSession()"/>
      <button class="h-fit" *ngIf="ready" title="Go to session Preview Mode" (click)="goTo()">Session Preview
      </button>
    </div>
    <nt-player class="w-11/12 m-5 ml-8 " *ngIf="ready" [session]="eventList"></nt-player>
    <div class="flex flex-row">
      <div class="flex items-center">
        <button class="m-4 bo-button" *ngIf="ready" (click)="getSessionTest()">Generate test e2e</button>
        <button class="m-4 bo-button"
                *ngIf="ready && session.info?.e2eScript && !generatingScript"
                (click)="showScript = true">Show test e2e
        </button>
      </div>
      <div *ngIf="generatingScript" class="flex flex-row items-center justify-center">
        <div class="bo-loading m-4"></div>
        <div class="text-nt-300 text-bold">Generating Script...</div>
      </div>
    </div>
  </div>
  <nt-session-devtool class="w-[650px]" [events]="eventList"></nt-session-devtool>
</div>

<nt-popup *ngIf="showScript" (close)="showScript = false" (clickOutside)="showScript = false">
  <nt-codemirror-editor
          [script]="session.info.e2eScript"
          class="editor"
          label="Test e2e">
  </nt-codemirror-editor>
</nt-popup>

<nt-popup *ngIf="jsonTemplate" [closeClickOutside]=false (close)="jsonTemplate = undefined">
  <bl-json-template class="block w-[1000px] h-[800px]" [data]="jsonTemplate!"></bl-json-template>
</nt-popup>
